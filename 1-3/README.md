Решение:
1) Разделяем данный паттерн по символу ?
2) Строим бор по паттернам без ?
3) Находим все вхождения паттернов алгоритмом Ахо-Корасика
4) Следим за тем, где начинается вхождение очередного паттерна без ? и за его вхождением в исходный паттерн
5) Если сложилась ситуация, когда i-ый подшаблон вошёл на позиции j, следующий за ним на позиции j - l_i + 1 
(где l_i - входжение i-ого подшаблона в шаблон), для всех подшаблонов, то значит мы нашли вхождение шаблона с ? в текст

Когда находим очередной подшаблон в тексте на позиции j, то увеличиваем number_of_matches[j - l_i + 1] на один.
Рассмотрим подсроку T[i…i+n−1]. Равенство number_of_matches[i]=k (где k - количество безмасочных шаблонов) будет означать, что подстроки текста T[i+l1…i+l1+|Q1|−1],T[i+l2…i+l2+|Q2|−1] и так далее будут равны соответственно безмасочным подстрокам шаблона {Q1,…,Qk}. Остальная часть шаблона является масками, поэтому шаблон входит в текст на позиции i.

Ахо-Корасик выполняется за время O(m+n+a), где n — длина шаблона, m — длина текста, a — количество появлений подстрок шаблона. 
Далее просто надо пробежаться по массиву, где записаны индексы вхождений подшаблонов, и просмотреть значения ячеек за время O(m).